p8105_hw3_nl2835
================
Nancy Le
2023-10-09

``` r
library(tidyverse)
library(p8105.datasets)
library(ggplot2)
data("instacart")
```

### Problem 1

The Instacart dataset has 1384617 observations and 15 variables, which
include `order_id`, `product_id`, the `user_id`, `product_name`s, and
which location of the supermarket the products were found (as in, the
`department` and `aisle`).

User IDs ranged from 1 to 206209.

``` r
num_aisles <- instacart |> 
  select(aisle) |> 
  distinct() |> 
  nrow()

print(num_aisles)
## [1] 134
```

There are 134 aisles.

``` r
count_items_aisle <- instacart |> 
 group_by(aisle_id) |> 
 count() |> 
  arrange(desc(n))
```

The aisle with the most items ordered from is 83.

``` r
instacart = instacart |> 
  group_by(aisle_id) |> 
  mutate(total_product_count = n()) |> 
  select(order_id, aisle_id, product_id, total_product_count, everything())
```

``` r
subset_instacart = instacart |> 
  filter(total_product_count > 10000) 
```

``` r
subset_instacart |> 
  ggplot(aes(x = aisle_id, y = total_product_count)) + geom_point() + labs(
    title = "Number of Products Ordered by Aisle",
    x = "Aisle ID",
    y = "Number of Products Ordered",
    caption = "Data from Instacart") +
  scale_x_continuous(
    breaks = seq(0, 135, by = 1)
  )
```

![](p8105_hw3_nl2835_files/figure-gfm/scatterplot%20items%20by%20aisle-1.png)<!-- -->

``` r

#need to go back and fix aisle id labels - maybe should use text labels above just the top 3 product counts?
```

``` r
subset_instacart |> 
ggplot(aes(x = aisle_id, y = total_product_count)) + 
  geom_bar(stat = "identity") + 
  scale_x_discrete(labels = subset_instacart$aisle_id)
```

![](p8105_hw3_nl2835_files/figure-gfm/bar%20plot%20items%20by%20aisle-1.png)<!-- -->

``` r
three_depts = instacart |> 
  filter(aisle == c("baking ingredients", "dog food care", "packaged vegetables fruits")) |> 
  group_by(product_id, aisle_id) 
## Warning: There were 104 warnings in `filter()`.
## The first warning was:
## ℹ In argument: `aisle == c("baking ingredients", "dog food care", "packaged
##   vegetables fruits")`.
## ℹ In group 1: `aisle_id = 1`.
## Caused by warning in `aisle == c("baking ingredients", "dog food care", "packaged vegetables fruits")`:
## ! longer object length is not a multiple of shorter object length
## ℹ Run `dplyr::last_dplyr_warnings()` to see the 103 remaining warnings.
```

``` r
three_depts = three_depts |> 
  mutate(product_count = 1) |> 
  select(aisle_id, aisle, product_id, product_name, product_count, everything()) 
```

``` r
top_three = three_depts |> 
  group_by(aisle_id, product_name) |> 
  summarize(product_count = sum(product_count)) |> 
  arrange(desc(product_count))  |> 
  slice_head(n = 3) |> 
  select(product_name, product_count, aisle_id) 
```

``` r
library(knitr)
kable(top_three, caption = "Top 3 Products By Aisle")
```

| product_name                                  | product_count | aisle_id |
|:----------------------------------------------|--------------:|---------:|
| Light Brown Sugar                             |           157 |       17 |
| Pure Baking Soda                              |           126 |       17 |
| Organic Unbleached All-Purpose Flour          |           108 |       17 |
| Dog Snacks, Medium                            |            10 |       40 |
| Small Dog Biscuits                            |            10 |       40 |
| Chicken and Liver Canine Cuisine Wet Dog Food |             9 |       40 |
| Organic Baby Spinach                          |          3272 |      123 |
| Organic Raspberries                           |          1851 |      123 |
| Organic Blueberries                           |          1642 |      123 |

Top 3 Products By Aisle

``` r
days_df <- 
  tibble(
    day_num = 0:6,
    day_abb = c("Sun", "Mon", "Tues", "Wed", "Thurs", "Fri", "Sat")
  )
```

``` r
replacement_vector <- setNames(days_df$day_abb, days_df$day_num)
```

``` r
pla_cic = instacart |> 
  filter(product_name == c(
    "Pink Lady Apples", "Coffee Ice Cream")) |> 
  group_by(order_dow, product_name) |>
  summarize(mean_hr = mean(order_hour_of_day)) |> 
  spread(key = order_dow, value = mean_hr) 
## Warning: There were 65 warnings in `filter()`.
## The first warning was:
## ℹ In argument: `product_name == c("Pink Lady Apples", "Coffee Ice Cream")`.
## ℹ In group 2: `aisle_id = 2`.
## Caused by warning in `product_name == c("Pink Lady Apples", "Coffee Ice Cream")`:
## ! longer object length is not a multiple of shorter object length
## ℹ Run `dplyr::last_dplyr_warnings()` to see the 64 remaining warnings.
```

``` r
library(knitr)
kable(pla_cic, caption = "Mean Hour Ordered")
```

| product_name     |       0 |        1 |        2 |        3 |        4 |        5 |        6 |
|:-----------------|--------:|---------:|---------:|---------:|---------:|---------:|---------:|
| Coffee Ice Cream | 12.4000 | 15.25000 | 15.76923 | 15.87500 | 14.86667 | 13.16667 | 13.88889 |
| Pink Lady Apples | 13.5625 | 11.77778 | 12.16000 | 13.11111 | 11.28571 | 12.12903 | 12.14286 |

Mean Hour Ordered

## Problem 2

``` r
data("brfss_smart2010")
```

``` r
brfss = brfss_smart2010 |> 
  janitor::clean_names() |> 
  filter(topic=="Overall Health") |> 
  drop_na(response) |> 
  mutate(response = as_factor(response)) |> 
  mutate(locationdesc = substring(locationdesc, 5)) |> 
  rename(county = locationdesc, state = locationabbr, overall_health = data_value)
```

``` r
states_seven_2002 = brfss |> 
  filter(year=="2002") |> 
  group_by(state) |> 
  summarize(unique_counties = n_distinct(county)) |> 
  filter(unique_counties >= 7)
```

``` r
states_seven_2010 = brfss |> 
  filter(year=="2010") |> 
  group_by(state) |> 
  summarize(unique_counties = n_distinct(county)) |> 
  filter(unique_counties >= 7)
```

#### 2002 - States \>= 7 Locations

``` r
library(knitr)
kable(states_seven_2002)
```

| state | unique_counties |
|:------|----------------:|
| CT    |               7 |
| FL    |               7 |
| MA    |               8 |
| NC    |               7 |
| NJ    |               8 |
| PA    |              10 |

#### 2010 - States \>= 7 Locations

``` r
kable(states_seven_2010)
```

| state | unique_counties |
|:------|----------------:|
| CA    |              12 |
| CO    |               7 |
| FL    |              41 |
| MA    |               9 |
| MD    |              12 |
| NC    |              12 |
| NE    |              10 |
| NJ    |              19 |
| NY    |               9 |
| OH    |               8 |
| PA    |               7 |
| SC    |               7 |
| TX    |              16 |
| WA    |              10 |

``` r
excellent = brfss |> 
  filter(response == "Excellent") |> 
  group_by(state, year) |> 
  mutate(mean_overall_health = mean(overall_health, na.rm = TRUE)) |> 
  select(year, state, mean_overall_health)
```

``` r
excellent |> 
  ggplot(
  aes(x = year, y = mean_overall_health, group = state, color = state)) + geom_line() +
  labs(
    title = "Spaghetti Plot of Mean Data Value by State", 
    x = "Year", 
    y = "Overall Health"
  )
```

![](p8105_hw3_nl2835_files/figure-gfm/excellent%20spaghetti%20plot-1.png)<!-- -->

``` r
nytwopanel = brfss |> 
  filter(year == 2006 | year == 2010) |> 
  filter(state == "NY")  |>  
  group_by(state, year, county) 
```

``` r
ggplot(nytwopanel, aes(x = overall_health, color = response)) + 
  geom_density(alpha = .5) + 
  facet_grid(. ~ year) +
  ggtitle("Response Distribution by Overall Health")
```

![](p8105_hw3_nl2835_files/figure-gfm/density%20plot-1.png)<!-- -->

``` r
ggplot(nytwopanel, aes(y = overall_health, x = response, color = county, group = county)) + 
  geom_point(alpha = .5) + 
  facet_grid(year ~ .) + 
  ggtitle("Response Distribution by Overall Health")
```

![](p8105_hw3_nl2835_files/figure-gfm/scatter%20plot-1.png)<!-- -->
